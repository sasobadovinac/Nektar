<!-- Sliding wall with inflow freestream, for testing EnforceRhoP BC-->
<?xml version="1.0" encoding="utf-8" ?>
<NEKTAR>
    <GEOMETRY DIM="2" SPACE="2">
        <VERTEX>
            <V ID="0">1.00000000e-01 0.00000000e+00 0.00000000e+00</V>
            <V ID="1">1.00000000e-01 1.49999997e-02 0.00000000e+00</V>
            <V ID="2">7.99999617e-02 0.00000000e+00 0.00000000e+00</V>
            <V ID="3">8.00000355e-02 2.60000071e-02 0.00000000e+00</V>
            <V ID="4">1.00000000e-01 3.00000000e-02 0.00000000e+00</V>
            <V ID="5">6.00000355e-02 2.20000071e-02 0.00000000e+00</V>
            <V ID="6">5.99999617e-02 0.00000000e+00 0.00000000e+00</V>
            <V ID="7">4.00000355e-02 1.80000071e-02 0.00000000e+00</V>
            <V ID="8">3.99999617e-02 0.00000000e+00 0.00000000e+00</V>
            <V ID="9">2.00000355e-02 1.40000071e-02 0.00000000e+00</V>
            <V ID="10">1.99999617e-02 0.00000000e+00 0.00000000e+00</V>
            <V ID="11">0.00000000e+00 1.00000000e-02 0.00000000e+00</V>
            <V ID="12">0.00000000e+00 0.00000000e+00 0.00000000e+00</V>
        </VERTEX>
        <EDGE>
            <E ID="0">0 1</E>
            <E ID="1">2 1</E>
            <E ID="2">2 0</E>
            <E ID="3">3 1</E>
            <E ID="4">2 3</E>
            <E ID="5">1 4</E>
            <E ID="6">4 3</E>
            <E ID="7">3 5</E>
            <E ID="8">2 5</E>
            <E ID="9">6 5</E>
            <E ID="10">6 2</E>
            <E ID="11">7 6</E>
            <E ID="12">8 7</E>
            <E ID="13">8 6</E>
            <E ID="14">9 8</E>
            <E ID="15">10 9</E>
            <E ID="16">10 8</E>
            <E ID="17">7 9</E>
            <E ID="18">10 11</E>
            <E ID="19">9 11</E>
            <E ID="20">12 10</E>
            <E ID="21">11 12</E>
            <E ID="22">5 7</E>
        </EDGE>
        <ELEMENT>
            <T ID="0">0 1 2</T>
            <T ID="1">3 4 1</T>
            <T ID="2">5 6 3</T>
            <T ID="3">7 8 4</T>
            <T ID="4">8 9 10</T>
            <T ID="5">11 12 13</T>
            <T ID="6">14 15 16</T>
            <T ID="7">17 14 12</T>
            <T ID="8">18 15 19</T>
            <T ID="9">20 18 21</T>
            <T ID="10">9 22 11</T>
        </ELEMENT>
        <CURVED />
        <COMPOSITE>
            <C ID="1"> E[16,20,13,10,2] </C>
            <C ID="2"> E[5,0] </C>
            <C ID="3"> E[19,17,22,7,6] </C>
            <C ID="4"> E[21] </C>
            <C ID="100"> T[0-10] </C>
        </COMPOSITE>
        <DOMAIN> C[100] </DOMAIN>
    </GEOMETRY>
    <Metadata>
        <Provenance>
            <GitBranch>refs/heads/master</GitBranch>
            <GitSHA1>21dc3e13700f49b1f702f47dec2aef90ff554701</GitSHA1>
            <Hostname>ae-gl19</Hostname>
            <NektarVersion>5.0.0</NektarVersion>
            <Timestamp>16-Oct-2020 16:36:30</Timestamp>
        </Provenance>
        <NekMeshCommandLine>SlidingWall.xml SlidingWall_Ascil.xml:xml:uncompress </NekMeshCommandLine>
    </Metadata>
  
  <EXPANSIONS>
    <E COMPOSITE="C[100]" NUMMODES="2" FIELDS="rho,rhou,rhov,E" TYPE="MODIFIED" />
  </EXPANSIONS>

  <CONDITIONS>
    <PARAMETERS>
      <P> Gamma                 = 1.4                  </P>
      <P> pInf                  = 101325               </P>
      <P> rhoInf                = 1.225                </P>
      <P> uInf                  = 9.18                 </P>
      <P> vInf                  = 0.0                  </P>

      <P> CFL                   = 1.0                  </P>
      <P> CFLGrowth             = 1.1                  </P>
      <P> CFL_End               = 100.0                </P>

      <P> NumSteps              = 50                   </P>
      <P> IO_InfoSteps          = 1                    </P>
      <P> IO_CheckSteps         = 100                  </P>

      <P> PrcdMatFreezNumb      = 10                   </P>
      <P> NewtonRelativeIteTol  = 1.0E-2               </P>
      <P> GMRESRelativeIteTol   = 1.0E-2               </P>
      <P> NewtonAbsoluteIteTol  = 1.0E-10              </P>
      <P> JFNKPrecondStep       = 7                    </P>

      <P> A_p                   = -1.0e4               </P>
      <P> A_rho                 = A_p/pInf*rhoInf*0.75 </P>
    </PARAMETERS>

    <SOLVERINFO>
      <I PROPERTY="EQType"                VALUE="EulerCFE"     />
      <I PROPERTY="Projection"            VALUE="DisContinuous"       />
      <I PROPERTY="AdvectionType"         VALUE="WeakDG"              />
      <I PROPERTY="DiffusionType"         VALUE="InteriorPenalty"     />
      <I PROPERTY="AdvectionAdvancement"  VALUE="Implicit"            />
      <I PROPERTY="DiffusionAdvancement"  VALUE="Implicit"            />
      <I PROPERTY="TimeIntegrationMethod" VALUE="DIRKOrder2"          />
      <I PROPERTY="UpwindType"            VALUE="Roe"                 />
      <I PROPERTY="ProblemType"           VALUE="General"             />
      <I PROPERTY="ViscosityType"         VALUE="Constant"            />
    </SOLVERINFO>

    <VARIABLES>
      <V ID="0"> rho  </V>
      <V ID="1"> rhou </V>
      <V ID="2"> rhov </V>
      <V ID="3"> E    </V>
    </VARIABLES>

    <BOUNDARYREGIONS>
      <B ID="0"> C[1] </B> <!-- wall -->
      <B ID="1"> C[2] </B> <!-- outflow -->
      <B ID="2"> C[4] </B> <!-- inflow -->
      <B ID="3"> C[3] </B> <!-- free stream-->
    </BOUNDARYREGIONS>

    <BOUNDARYCONDITIONS>
      <!-- Wall -->
      <REGION REF="0">
        <D VAR="rho"  USERDEFINEDTYPE="Wall" VALUE="0" />
        <D VAR="rhou" USERDEFINEDTYPE="Wall" VALUE="0" />
        <D VAR="rhov" USERDEFINEDTYPE="Wall" VALUE="0" />
        <D VAR="E"    USERDEFINEDTYPE="Wall" VALUE="0" />
      </REGION>
      <!-- outflow -->
      <REGION REF="1">
        <D VAR="rho"  USERDEFINEDTYPE="PressureOutflow" VALUE="0" />
        <D VAR="rhou" USERDEFINEDTYPE="PressureOutflow" VALUE="0" />
        <D VAR="rhov" USERDEFINEDTYPE="PressureOutflow" VALUE="0" />
        <D VAR="E"    USERDEFINEDTYPE="PressureOutflow" VALUE="pInf + A_p * x" />
      </REGION>

      <!-- inflow -->
      <REGION REF="2">
        <D VAR="rho"  VALUE="rhoInf + A_rho * x" />
        <D VAR="rhou" VALUE="(rhoInf + A_rho * x) * uInf" />
        <D VAR="rhov" VALUE="(rhoInf + A_rho * x) * vInf" />
        <D VAR="E"    VALUE="(pInf + A_p * x) / (Gamma - 1) + 0.5 * (rhoInf + A_rho * x) * (uInf * uInf + vInf * vInf)" />
      </REGION>
      <!-- freestream -->
      <REGION REF="3">
        <D VAR="rho"  USERDEFINEDTYPE="EnforceRhoP" VALUE="rhoInf + A_rho * x" />
        <D VAR="rhou" USERDEFINEDTYPE="EnforceRhoP" VALUE="(rhoInf + A_rho * x) * uInf" />
        <D VAR="rhov" USERDEFINEDTYPE="EnforceRhoP" VALUE="(rhoInf + A_rho * x) * vInf" />
        <D VAR="E"    USERDEFINEDTYPE="EnforceRhoP" VALUE="(pInf + A_p * x) / (Gamma - 1) + 0.5 * (rhoInf + A_rho * x) * (uInf * uInf + vInf * vInf)" />
      </REGION>
    </BOUNDARYCONDITIONS>

    <FUNCTION NAME="InitialConditions">
      <E VAR="rho"  VALUE="rhoInf + A_rho * x"     />
      <E VAR="rhou" VALUE="(rhoInf + A_rho * x) * uInf"   />
      <E VAR="rhov" VALUE="(rhoInf + A_rho * x) * vInf"   />
      <E VAR="E"    VALUE="(pInf + A_p * x) / (Gamma - 1) + 0.5 * (rhoInf + A_rho * x) * (uInf * uInf + vInf * vInf)"/>
    </FUNCTION>

    <FUNCTION NAME="ExactSolution">
      <E VAR="rho"  VALUE="rhoInf + A_rho * x" />
      <E VAR="rhou" VALUE="(rhoInf + A_rho * x) * uInf" />
      <E VAR="rhov" VALUE="(rhoInf + A_rho * x) * vInf" />
      <E VAR="E"    VALUE="(pInf + A_p * x) / (Gamma - 1) + 0.5 * (rhoInf + A_rho * x) * (uInf * uInf + vInf * vInf)" />
    </FUNCTION>

  </CONDITIONS>
</NEKTAR>
