<?xml version="1.0" encoding="utf-8" ?>
<NEKTAR>
    <GEOMETRY DIM="3" SPACE="3">
        <VERTEX>
            <V ID="0">0.00000000e+00 0.00000000e+00 5.00000000e-01</V>
            <V ID="1">5.00000000e-01 0.00000000e+00 5.00000000e-01</V>
            <V ID="2">5.00000000e-01 0.00000000e+00 0.00000000e+00</V>
            <V ID="3">0.00000000e+00 0.00000000e+00 0.00000000e+00</V>
            <V ID="4">0.00000000e+00 5.00000000e-01 5.00000000e-01</V>
            <V ID="5">5.00000000e-01 5.00000000e-01 5.00000000e-01</V>
            <V ID="6">5.00000000e-01 5.00000000e-01 0.00000000e+00</V>
            <V ID="7">0.00000000e+00 5.00000000e-01 0.00000000e+00</V>
            <V ID="8">0.00000000e+00 1.00000000e+00 5.00000000e-01</V>
            <V ID="9">5.00000000e-01 1.00000000e+00 5.00000000e-01</V>
            <V ID="10">5.00000000e-01 1.00000000e+00 0.00000000e+00</V>
            <V ID="11">0.00000000e+00 1.00000000e+00 0.00000000e+00</V>
            <V ID="12">0.00000000e+00 0.00000000e+00 1.00000000e+00</V>
            <V ID="13">5.00000000e-01 0.00000000e+00 1.00000000e+00</V>
            <V ID="14">0.00000000e+00 5.00000000e-01 1.00000000e+00</V>
            <V ID="15">5.00000000e-01 5.00000000e-01 1.00000000e+00</V>
            <V ID="16">0.00000000e+00 1.00000000e+00 1.00000000e+00</V>
            <V ID="17">5.00000000e-01 1.00000000e+00 1.00000000e+00</V>

            <V ID="18">5.00000000e-01 0.00000000e+00 1.00000000e+00</V>
            <V ID="19">1.00000000e+00 0.00000000e+00 1.00000000e+00</V>
            <V ID="20">1.00000000e+00 0.00000000e+00 0.00000000e+00</V>
            <V ID="21">5.00000000e-01 0.00000000e+00 0.00000000e+00</V>
            <V ID="22">5.00000000e-01 1.00000000e+00 1.00000000e+00</V>
            <V ID="23">1.00000000e+00 1.00000000e+00 1.00000000e+00</V>
            <V ID="24">1.00000000e+00 1.00000000e+00 0.00000000e+00</V>
            <V ID="25">5.00000000e-01 1.00000000e+00 0.00000000e+00</V>
        </VERTEX>
        <EDGE>
            <E ID="0">0 1</E>
            <E ID="1">1 2</E>
            <E ID="2">2 3</E>
            <E ID="3">3 0</E>
            <E ID="4">0 4</E>
            <E ID="5">1 5</E>
            <E ID="6">2 6</E>
            <E ID="7">3 7</E>
            <E ID="8">4 5</E>
            <E ID="9">5 6</E>
            <E ID="10">6 7</E>
            <E ID="11">7 4</E>
            <E ID="12">4 8</E>
            <E ID="13">5 9</E>
            <E ID="14">6 10</E>
            <E ID="15">7 11</E>
            <E ID="16">8 9</E>
            <E ID="17">9 10</E>
            <E ID="18">10 11</E>
            <E ID="19">11 8</E>
            <E ID="20">12 13</E>
            <E ID="21">13 1</E>
            <E ID="22">0 12</E>
            <E ID="23">12 14</E>
            <E ID="24">13 15</E>
            <E ID="25">14 15</E>
            <E ID="26">15 5</E>
            <E ID="27">4 14</E>
            <E ID="28">14 16</E>
            <E ID="29">15 17</E>
            <E ID="30">16 17</E>
            <E ID="31">17 9</E>
            <E ID="32">8 16</E>

            <E ID="33">18 19</E>
            <E ID="34">19 20</E>
            <E ID="35">20 21</E>
            <E ID="36">21 18</E>
            <E ID="37">18 22</E>
            <E ID="38">19 23</E>
            <E ID="39">20 24</E>
            <E ID="40">21 25</E>
            <E ID="41">22 23</E>
            <E ID="42">23 24</E>
            <E ID="43">24 25</E>
            <E ID="44">25 22</E>
        </EDGE>
        <FACE>
            <Q ID="0">0 1 2 3</Q>
            <Q ID="1">0 5 8 4</Q>
            <Q ID="2">1 6 9 5</Q>
            <Q ID="3">2 6 10 7</Q>
            <Q ID="4">3 7 11 4</Q>
            <Q ID="5">8 9 10 11</Q>
            <Q ID="6">8 13 16 12</Q>
            <Q ID="7">9 14 17 13</Q>
            <Q ID="8">10 14 18 15</Q>
            <Q ID="9">11 15 19 12</Q>
            <Q ID="10">16 17 18 19</Q>
            <Q ID="11">20 21 0 22</Q>
            <Q ID="12">20 24 25 23</Q>
            <Q ID="13">21 5 26 24</Q>
            <Q ID="14">22 4 27 23</Q>
            <Q ID="15">25 26 8 27</Q>
            <Q ID="16">25 29 30 28</Q>
            <Q ID="17">26 13 31 29</Q>
            <Q ID="18">27 12 32 28</Q>
            <Q ID="19">30 31 16 32</Q>

            <Q ID="20">33 34 35 36</Q>
            <Q ID="21">33 38 41 37</Q>
            <Q ID="22">34 39 42 38</Q>
            <Q ID="23">35 39 43 40</Q>
            <Q ID="24">36 40 44 37</Q>
            <Q ID="25">41 42 43 44</Q>
        </FACE>
        <ELEMENT>
            <H ID="0">0 1 2 3 4 5 </H>
            <H ID="1">5 6 7 8 9 10 </H>
            <H ID="2">11 12 13 1 14 15 </H>
            <H ID="3">15 16 17 6 18 19 </H>

            <H ID="4">20 21 22 23 24 25 </H>
        </ELEMENT>
        <CURVED />
        <COMPOSITE>
            <C ID="1"> F[0,3-4,8-12,14-16,18-19] </C>
            <C ID="2"> F[20-23,25]</C>

            <C ID="3"> F[2,7,13,17] </C>
            <C ID="4"> F[24] </C>

            <C ID="10"> H[0-3] </C>
            <C ID="11"> H[4] </C>

        </COMPOSITE>
        <DOMAIN>
            <D ID="0"> C[10] </D>
            <D ID="1"> C[11] </D>
        </DOMAIN>
    </GEOMETRY>
    <Metadata>
        <Provenance>
            <GitBranch>refs/heads/feature/Moving-geometry</GitBranch>
            <GitSHA1>4010859a4dd7218c178588a6f7de92227c605093</GitSHA1>
            <Hostname>Edwards-MacBook-Pro.local</Hostname>
            <NektarVersion>5.0.0</NektarVersion>
            <Timestamp>24-Jul-2020 12:01:28</Timestamp>
        </Provenance>
        <NekMeshCommandLine>cube.msh cube.xml:xml:uncompress </NekMeshCommandLine>
    </Metadata>
    <EXPANSIONS>
        <E COMPOSITE="C[10]" NUMMODES="8" TYPE="MODIFIED" FIELDS="u" />
        <E COMPOSITE="C[11]" NUMMODES="11" TYPE="MODIFIED" FIELDS="u" />
    </EXPANSIONS>

    <MOVEMENT>
        <ZONES>
            <FIXED ID="0" DOMAIN="D[0]" />
            <FIXED ID="1" DOMAIN="D[1]"/>
        </ZONES>
        <INTERFACES>
            <INTERFACE NAME="Sliding">
                <LEFT  ID="0" BOUNDARY="C[3]" />
                <RIGHT ID="1" BOUNDARY="C[4]"  />
            </INTERFACE>
        </INTERFACES>
    </MOVEMENT>

    <CONDITIONS>
        <PARAMETERS>
            <P> FinTime =  0.2 </P>
            <P> TimeStep = 0.001 </P>
            <P> NumSteps = FinTime/TimeStep </P>
            <P> IO_CheckSteps = 9999 </P>
            <P> IO_InfoSteps = 100 </P>
            <P> advx = 1 </P>
            <P> advy = 1 </P>
            <P> advz = 1 </P>
            <P> k = 2*PI </P>
        </PARAMETERS>

        <SOLVERINFO>
            <I PROPERTY="EQTYPE" VALUE="UnsteadyAdvection" />
            <I PROPERTY="Projection" VALUE="DisContinuous" />
            <I PROPERTY="AdvectionType" VALUE="WeakDG" />
            <I PROPERTY="UpwindType" VALUE="Upwind" />
            <I PROPERTY="TimeIntegrationMethod" VALUE="ClassicalRungeKutta4"/>
            <I PROPERTY="WEIGHTPARTITIONS" VALUE="DOF" />
        </SOLVERINFO>

        <VARIABLES>
            <V ID="0"> u </V>
        </VARIABLES>

        <BOUNDARYREGIONS>
            <B ID="0"> C[1,2] </B> <!--- sides -->
        </BOUNDARYREGIONS>

        <BOUNDARYCONDITIONS>
            <REGION REF="0">
                <D VAR="u" USERDEFINEDTYPE="TimeDependent" VALUE="sin(k*(x-advx*t))*cos(k*(y-advy*t))*cos(k*(z-advz*t))" />
            </REGION>
        </BOUNDARYCONDITIONS>

        <FUNCTION NAME="InitialConditions">
            <E VAR="u" VALUE="sin(k*(x-advx))*cos(k*(y-advy))*cos(k*(z-advz))" />
        </FUNCTION>

        <FUNCTION NAME="AdvectionVelocity">
            <E VAR="Vx" VALUE="advx" />
            <E VAR="Vy" VALUE="advy" />
            <E VAR="Vz" VALUE="advz" />
        </FUNCTION>

        <FUNCTION NAME="ExactSolution">
            <E VAR="u" VALUE="sin(k*(x-advx*t))*cos(k*(y-advy*t))*cos(k*(z-advz*t))" />
        </FUNCTION>

    </CONDITIONS>
</NEKTAR>
